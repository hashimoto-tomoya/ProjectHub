---
name: mob-docs-basic-design
description: "Webアプリケーションの基本設計ドキュメント作成を支援するスキル。Small/Fullの設計書テンプレートに対応し、プロジェクト規模に応じた基本設計ドキュメントを体系的に作成する。要件定義・方式設計の成果物を入力として、具体的な設計仕様をMaterial for MkDocs形式のドキュメントとして出力する。トリガー: (1) 基本設計書の作成・編集を依頼された時、(2) 「基本設計」「basic design」に言及された時、(3) システム構成・画面設計・データモデル・API設計・バッチ設計の作成を依頼された時、(4) 画面レイアウトやテーブル定義、API仕様の設計を行う時。"
---

# 基本設計ドキュメント作成スキル

## テンプレート判定

作業開始時にプロジェクトの CLAUDE.md を読み、「設計書テンプレート」の値（Small / Full）を確認する。
テンプレートの種別に応じてワークフロー・ファイル構成・成果物が変わるため、必ず最初に確認すること。

## ワークフロー概要

基本設計ドキュメントの作成は、設計書テンプレートに応じた以下のカテゴリで進める。

### Fullテンプレート（5カテゴリ）

1. **システム構成** — システム全体像、モジュール構成、外部インターフェースの定義
2. **画面設計** — 画面一覧、画面遷移図、各画面のレイアウト・機能の定義
3. **データモデル** — ER図、テーブル定義、マスタデータの定義
4. **API設計** — API設計方針、各エンドポイントの仕様定義
5. **バッチ設計** — バッチ処理一覧、各バッチの仕様定義

システム構成を最初に確定させ、その全体像に基づいて他カテゴリを進めること。

### Smallテンプレート（3カテゴリ）

1. **画面設計** — 画面一覧・遷移・主要画面定義を1ファイルに統合
2. **データモデル** — ER図・テーブル定義を1ファイルに統合
3. **API設計** — API方針・主要エンドポイントを1ファイルに統合

Smallではシステム構成・バッチ設計は独立カテゴリとしない。
システム構成の要点は方式設計のアーキテクチャ方式でカバーされているものとし、バッチ処理がある場合はAPI設計内で簡潔に触れる。

## 前提条件

基本設計は要件定義（`docs/01-requirements/`）と方式設計（`docs/02-technical-design/`）の成果物を入力とする。特に以下を参照する：

- **要件定義**
  - 機能要件（各機能モジュール）→ 画面・API・データモデルの設計根拠
  - 非機能要件（性能・セキュリティ）→ 設計上の制約
  - ユースケース → 画面遷移・APIフローの根拠（Fullのみ）
  - ビジネス要件（業務フロー・ビジネスルール）→ バッチ処理・データモデルの根拠（Fullのみ）
- **方式設計**
  - アーキテクチャ方式 → システム構成・モジュール分割の方針
  - 技術スタック → 具体的な技術選定に基づく設計
  - データ方式 → データモデル・テーブル設計の方針（Fullのみ）
  - セキュリティ方式 → 認証・認可に関わるAPI・画面設計（Fullのみ）
  - インフラ方式 → バッチ実行基盤・外部連携方式（Fullのみ）

**Smallテンプレートの場合の注意:**
要件定義・方式設計がSmall構成の場合、各統合ファイルの該当セクションを参照する。

作業開始前に、対象カテゴリに関連する要件定義・方式設計ドキュメントを必ず読み込むこと。

## 作業プロセス

### 0. index.md の確認（初回のみ）

`docs/03-basic-design/index.md` が未作成の場合、以下を含めて作成する：

- セクション概要
- 構成説明（各カテゴリの役割）
- **成果物一覧テーブル**（ステータス管理用）

成果物一覧テーブルはテンプレートに応じて以下を使い分ける：

**Fullテンプレート:**

```markdown
| 成果物 | 説明 | ステータス |
|--------|------|-----------|
| システム構成 | 全体像・モジュール・外部I/F | 未着手 |
| 画面設計 | 画面一覧・遷移・レイアウト | 未着手 |
| データモデル | ER図・テーブル定義 | 未着手 |
| API設計 | 設計方針・エンドポイント仕様 | 未着手 |
| バッチ設計 | バッチ一覧・バッチ定義 | 未着手 |
```

**Smallテンプレート:**

```markdown
| 成果物 | 説明 | ステータス |
|--------|------|-----------|
| 画面設計 | 画面一覧・遷移・主要画面定義 | 未着手 |
| データモデル | ER図・テーブル定義 | 未着手 |
| API設計 | API方針・主要エンドポイント | 未着手 |
```

### 1. 対象カテゴリの特定

ユーザーの依頼内容から作成対象を判断する：

- **タスク番号指定あり** → docs/index.md の「成果物一覧」から該当タスクに対応するファイル群を作成
- **カテゴリ名指定あり** → 該当カテゴリのファイル群を作成
- **指定なし** → 最初のカテゴリから順に提案

タスク番号とカテゴリの対応はテンプレートにより異なる：

**Fullテンプレート:**

| タスク | カテゴリ | 対象ファイル |
|--------|----------|-------------|
| #11 | システム構成 | system-overview.md / module-structure.md / external-interfaces.md |
| #12 | 画面設計 | screen-list.md / screen-transition.md / 個別画面定義 |
| #13 | データモデル | er-diagram.md / master-data.md / テーブル定義 |
| #14 | API設計 | api-overview.md / 個別API仕様 |
| #15 | バッチ設計 | batch-list.md / 個別バッチ定義 |

**Smallテンプレート:**

| タスク | カテゴリ | 対象ファイル |
|--------|----------|-------------|
| #6 | 画面設計 | screen-design.md |
| #7 | データモデル | data-model.md |
| #8 | API設計 | api-design.md |

※ 各タスクの具体的な対象ファイル数・ファイル名は docs/index.md の「成果物一覧」を参照すること。

### 2. 関連ドキュメントの読み込み

対象カテゴリに応じて、前フェーズのドキュメントを読み込む：

**Fullテンプレート:**

| カテゴリ | 必須参照ドキュメント |
|----------|---------------------|
| システム構成 | scope.md, architecture-pattern.md, technology-stack.md, system-context.md, cloud-architecture.md |
| 画面設計 | 機能要件全般, ユースケース全般, technology-stack.md（FE技術） |
| データモデル | 機能要件全般, business-rules.md, database-selection.md, caching-strategy.md |
| API設計 | 機能要件全般, ユースケース全般, architecture-pattern.md, authentication.md, authorization.md |
| バッチ設計 | business-flow.md, 機能要件全般, cloud-architecture.md, monitoring.md |

**Smallテンプレート:**

| カテゴリ | 必須参照ドキュメント |
|----------|---------------------|
| 画面設計 | functional-requirements.md, architecture.md（FE技術） |
| データモデル | functional-requirements.md, architecture.md（DB選定） |
| API設計 | functional-requirements.md, architecture.md（認証・通信方式） |

### 3. 既存テンプレートの確認

対象ファイルを読み込み、テンプレート構造（見出し・プレースホルダーコメント）を確認する。
テンプレートの `<!-- ... -->` コメントは記載すべき内容のガイドである。

### 4. ユーザーとの対話による方針決定

基本設計ではシステムの具体的な構造・仕様を決定する。質問は一度に3〜5個に抑え、段階的に深掘りする。

**質問の優先順位:**

1. 業務要件に影響する設計判断（画面構成の方針、データの正規化レベル 等）
2. ユーザー体験に関する判断（画面遷移パターン、レスポンス形式 等）
3. 技術的なトレードオフ（API粒度、バッチ vs リアルタイム 等）

**基本設計特有の対話方針:**

- 方式設計で決定済みの方針を前提に、具体化の方向性を確認する
- 画面設計では、ワイヤーフレームレベルの構成要素を確認する（デザインの詳細ではない）
- データモデルでは、主要エンティティの関連性と正規化方針を確認する
- API設計では、リソース設計の粒度とエンドポイント命名規則を確認する
- 未確定事項は仮決定として記録し、詳細設計フェーズで確定する旨を明記する

**Smallテンプレートの場合の注意:**
質問は主要な画面構成・データ構造・APIエンドポイントに絞り、各カテゴリの詳細な深掘りは最小限にする。

### 5. ドキュメント作成

テンプレートのプレースホルダーを実際の内容に置き換える。

**出力ルール:**

- Material for MkDocs互換のMarkdown形式で記述する
- 図表はMermaid記法を使用する（システム構成図、画面遷移図、ER図、シーケンス図等）
- テーブルはMarkdownテーブルを使用する
- Admonition（`!!! note`、`!!! warning`、`!!! info` 等）を適宜活用する
- `<!-- ... -->` プレースホルダーコメントは残さず、すべて実際の内容に置き換える

**基本設計特有の記述スタイル:**

- **具体性を重視する** — 方式設計の抽象的な方針を、実装可能なレベルまで具体化する
- **一貫性を保つ** — 命名規則、ID体系、フォーマットをカテゴリ横断で統一する
- **トレーサビリティを確保する** — 要件ID・方式設計の決定事項との紐付けを明記する
- **図表を多用する** — システム構成図、画面遷移図、ER図等、視覚的な表現を積極活用する
- 未確定事項には `!!! warning "要確認"` アドモニションを付与する

**ID体系:**

基本設計では以下のID体系を使用する（プロジェクトに応じて調整可）：

| カテゴリ | ID形式 | 例 |
|----------|--------|-----|
| 画面（エンドユーザー向け） | SCR-C-XXX | SCR-C-001 |
| 画面（管理者向け） | SCR-A-XXX | SCR-A-001 |
| テーブル | TBL-XXX | TBL-001 |
| API（エンドユーザー向け） | API-C-XXX | API-C-001 |
| API（管理者向け） | API-A-XXX | API-A-001 |
| バッチ | BAT-XXX | BAT-001 |

**Smallテンプレートの場合の記述方針:**

- 各統合ファイル内ではH2レベルで大分類、H3レベルで小分類に整理する
- 画面定義は主要画面（5〜10画面程度）に絞り、一覧テーブル＋主要画面の詳細で構成する
- テーブル定義は主要テーブルに絞り、ER図＋主要テーブルのカラム定義で構成する
- API定義は主要エンドポイントに絞り、API方針＋主要エンドポイントの仕様で構成する
- ID体系はFullと同じものを使用する（一貫性のため）

### 6. レビューと更新

作成したドキュメントの要約をユーザーに提示し、フィードバックを反映する。

## カテゴリ別リファレンス

各カテゴリの詳細な作成ガイドは以下のリファレンスを参照する。
テンプレートによって参照するガイドと使い方が異なる。

### Fullテンプレート

- **システム構成**（system-overview.md / module-structure.md / external-interfaces.md）の作成時:
  → [references/system-architecture-guide.md](references/system-architecture-guide.md) を読む

- **画面設計**（screen-list.md / screen-transition.md / 各画面定義）の作成時:
  → [references/screen-design-guide.md](references/screen-design-guide.md) を読む

- **データモデル**（er-diagram.md / master-data.md / テーブル定義）の作成時:
  → [references/data-model-guide.md](references/data-model-guide.md) を読む

- **API設計**（api-overview.md / 各API仕様）の作成時:
  → [references/api-design-guide.md](references/api-design-guide.md) を読む

- **バッチ設計**（batch-list.md / 各バッチ定義）の作成時:
  → [references/batch-design-guide.md](references/batch-design-guide.md) を読む

### Smallテンプレート

- **画面設計**（screen-design.md）の作成時:
  → [references/screen-design-guide.md](references/screen-design-guide.md) を読む
  → ガイド内の「Smallテンプレートの場合」セクションに従い、1ファイルに統合する

- **データモデル**（data-model.md）の作成時:
  → [references/data-model-guide.md](references/data-model-guide.md) を読む
  → ガイド内の「Smallテンプレートの場合」セクションに従い、1ファイルに統合する

- **API設計**（api-design.md）の作成時:
  → [references/api-design-guide.md](references/api-design-guide.md) を読む
  → ガイド内の「Smallテンプレートの場合」セクションに従い、1ファイルに統合する

## ファイル構成

基本設計ドキュメントは `docs/03-basic-design/` 配下に格納する。

### Fullテンプレート

```
docs/03-basic-design/
├── index.md                          # セクション概要・進捗管理
├── system-architecture/
│   ├── system-overview.md           # システム全体像
│   ├── module-structure.md          # モジュール構成
│   └── external-interfaces.md      # 外部インターフェース
├── screen-design/
│   ├── screen-list.md               # 画面一覧
│   ├── screen-transition.md         # 画面遷移図
│   ├── {エンドユーザー種別}/          # エンドユーザー向け画面（1画面1ファイル）
│   │   └── {画面名}.md
│   └── admin/                       # 管理者向け画面（1画面1ファイル）
│       └── {画面名}.md
├── data-model/
│   ├── er-diagram.md               # ER図
│   ├── master-data.md              # マスタデータ定義
│   └── table-definitions/          # テーブル定義（1テーブル1ファイル）
│       └── {テーブル名}.md
├── api-design/
│   ├── api-overview.md             # API設計方針
│   ├── {エンドユーザー種別}/          # エンドユーザー向けAPI（ドメイン単位）
│   │   └── {ドメイン名}-api.md
│   └── admin/                       # 管理者向けAPI（ドメイン単位）
│       └── {ドメイン名}-admin-api.md
└── batch-design/
    ├── batch-list.md               # バッチ一覧
    └── batch-definitions/          # バッチ定義（1バッチ1ファイル）
        └── {バッチ名}.md
```

### Smallテンプレート

```
docs/03-basic-design/
├── index.md                          # セクション概要・進捗管理
├── screen-design.md                  # 画面一覧・遷移・主要画面定義を統合
├── data-model.md                     # ER図・テーブル定義を統合
└── api-design.md                     # API方針・主要エンドポイントを統合
```

## カテゴリ間の依存関係

### Fullテンプレート

```
システム構成 ──→ 画面設計
     │       ──→ データモデル
     │       ──→ API設計
     └─────────→ バッチ設計

画面設計 ←──→ API設計（画面操作とAPI呼び出しの対応）
データモデル ←──→ API設計（データ構造とリソース設計の対応）
データモデル ←──→ バッチ設計（データ操作対象の対応）
```

- システム構成が全カテゴリの基盤（最初に確定）
- 画面設計はフロントエンドの構造を定義し、API設計と連動する
- データモデルはバックエンドのデータ構造を定義し、API・バッチと連動する
- API設計は画面設計とデータモデルを繋ぐインターフェースを定義する
- バッチ設計はデータモデルに対する定期処理を定義する

### Smallテンプレート

```
画面設計 ←──→ API設計
データモデル ←──→ API設計
```

- 画面設計とAPI設計は相互に連動する
- データモデルはAPI設計のリソース構造の根拠となる
- 3カテゴリは相互依存が強いため、並行して進めつつ整合性を確認する

## ステータス管理

`index.md` の成果物一覧テーブルのステータスを以下のタイミングで更新する：

| ステータス | 更新タイミング |
|-----------|---------------|
| 未着手 | index.md 作成時の初期値 |
| 対応中 | カテゴリのドキュメント作成に着手した時 |
| 完了 | カテゴリのすべてのドキュメントが作成完了した時 |

**重要:** カテゴリの作成に着手する際は、ドキュメント編集の前に必ずステータスを「対応中」に更新すること。
