# 非機能要件セクション 作成ガイド

## 目次

1. [Smallテンプレートの場合](#smallテンプレートの場合)
2. [共通の記述方針](#共通の記述方針)
3. [性能要件 (performance.md)](#性能要件)
4. [可用性要件 (availability.md)](#可用性要件)
5. [拡張性要件 (scalability.md)](#拡張性要件)
6. [セキュリティ要件 (security.md)](#セキュリティ要件)
7. [法規制・コンプライアンス (compliance.md)](#法規制コンプライアンス)

## Smallテンプレートの場合

Smallテンプレートでは、全非機能要件を **`non-functional-requirements.md`** 1ファイルに統合して記述する。
Fullでは5カテゴリが独立ファイルとなるが、Smallでは1ファイル内のセクションとしてまとめる。

### 推奨構成

```markdown
# 非機能要件

## 性能要件

### レスポンスタイム

| 対象 | 目標値 | 条件 |
|------|--------|------|
| 主要ページ表示 | X秒以内 | 通常負荷時 |
| API応答（平均） | Xms以内 | P95基準 |

### スループット
{同時接続数・RPSの目標値を簡潔に記述}

## 可用性要件

| 項目 | 内容 |
|------|------|
| 目標稼働率 | 99.X% |
| RTO | X時間以内 |
| RPO | X時間以内 |
| 計画メンテナンス | {ウィンドウ} |

## セキュリティ要件

### 認証・認可
{認証方式とセッション管理を簡潔に記述}

### データ保護
{通信・保存時の暗号化方針}

## 法規制・コンプライアンス
{準拠すべき法令・規制を箇条書きで列挙し、各対応方針を1〜2行で記述}
```

### Fullとの主な差異

- 5カテゴリすべてを1ファイル内のH2セクションとしてまとめる
- 拡張性要件は省略可（Smallの場合、初期スケールで十分なことが多い）
- 各カテゴリの記述量を簡潔にする（要点テーブル＋補足1〜2文程度）
- 要件IDは付与してもよいが、小規模の場合は省略可
- 以下の各カテゴリ別ガイドの内容を参考にしつつ、小規模プロジェクトに必要十分な粒度でまとめる

---

## 共通の記述方針

### 非機能要件の記述フォーマット

各項目に以下を含める：

- **要件ID**: NFR-{カテゴリ}-{連番}
- **要件名**: 簡潔な名称
- **要件内容**: 具体的な要件（定量的に記述）
- **測定方法**: どのように測定・検証するか
- **優先度**: Must / Should / Could

### 要件IDの命名規則

- NFR-PERF: 性能要件
- NFR-AVL: 可用性要件
- NFR-SCL: 拡張性要件
- NFR-SEC: セキュリティ要件
- NFR-CMP: コンプライアンス要件

---

## 性能要件

### レスポンスタイム

プロジェクトの主要画面・操作に対して目標値を設定する。以下はフォーマット例：

| 対象 | 目標値 | 条件 |
|------|--------|------|
| 主要ページ表示 | X秒以内 | 通常負荷時 |
| 一覧表示 | X秒以内 | N件表示時 |
| 詳細表示 | X秒以内 | メディア込み |
| 検索結果表示 | X秒以内 | 通常負荷時 |
| データ更新操作 | X秒以内 | - |
| 外部API連携処理 | X秒以内 | 外部API含む |
| API応答（平均） | Xms以内 | P95/P99も定義 |

### スループット

- 通常時の同時接続数
- ピーク時の同時接続数（イベント、キャンペーン等のピーク要因を明記）
- 秒間リクエスト処理数（RPS）

### データ量

- 初期データ量（主要エンティティの想定件数）
- 年間増加率の想定
- データ保持期間

### 品質基準

- すべての数値目標に「通常時」「ピーク時」の区別があること
- P95/P99パーセンタイルが定義されていること
- 測定ツール・手法が明記されていること

---

## 可用性要件

### 記述項目

| 項目 | 内容 |
|------|------|
| 目標稼働率 | 99.X%（年間許容ダウンタイム: X時間） |
| サービス提供時間 | 24/365 or 業務時間帯 |
| 計画メンテナンス | ウィンドウ時間帯、頻度、通知方法 |
| RTO（目標復旧時間） | 障害発生からサービス復旧までの時間 |
| RPO（目標復旧時点） | 許容されるデータ損失の時間幅 |
| 単一障害点 | SPOF排除の方針 |
| フェイルオーバー | 自動/手動切り替え方針 |

### SLA等級の参考

| 等級 | 稼働率 | 年間ダウンタイム |
|------|--------|----------------|
| 99.9% | Three Nines | 約8.7時間 |
| 99.95% | Three and a Half Nines | 約4.4時間 |
| 99.99% | Four Nines | 約52分 |

---

## 拡張性要件

### 記述項目

#### 水平スケーリング
- トラフィック増加時のスケールアウト方針
- オートスケーリングの条件・閾値
- スケール上限

#### 機能拡張性
- 新機能追加の容易さ（プラグイン機構等）
- 外部サービス連携の拡張性
- API バージョニング方針

#### データスケーリング
- DB分割（シャーディング）方針
- アーカイブ方針
- 検索インデックスの拡張性

---

## セキュリティ要件

### 記述項目

#### 認証・認可
- 認証方式（パスワード、MFA、OAuth 2.0、OIDC）
- セッション管理（有効期限、同時ログイン制御）
- 認可レベル（ロールベース、属性ベース）

#### データ保護
- 通信暗号化（TLS 1.3）
- データ暗号化（保存時暗号化: AES-256等）
- 個人情報のマスキング・匿名化

#### 脆弱性対策
- OWASP Top 10への対応方針
- 脆弱性スキャン頻度
- ペネトレーションテスト計画

#### 監査・ログ
- 操作ログの記録範囲
- アクセスログの保持期間
- 不正アクセス検知ルール

---

## 法規制・コンプライアンス

### 記述項目

#### 個人情報保護法
- 取得する個人情報の範囲
- 利用目的の明示方法
- 同意取得フロー
- 開示・訂正・削除請求への対応
- 第三者提供ルール

#### 業種固有の法規制
プロジェクトのドメインに応じて該当する法規制を洗い出す。

**例:**
- EC → 特定商取引法（表示義務、クーリングオフ）、資金決済法、割賦販売法
- 医療 → 医療法、薬機法
- 金融 → 金融商品取引法、犯罪収益移転防止法
- 教育 → 学校教育法、著作権法

#### アクセシビリティ
- WCAG準拠レベル（A / AA / AAA）
- 対応範囲（全ページ or 主要ページ）
- テスト方法

### 品質基準

- 準拠すべき法令・規制が一覧化されていること
- 各法令への具体的な対応方針が記述されていること
- 法改正時の対応プロセスが言及されていること
