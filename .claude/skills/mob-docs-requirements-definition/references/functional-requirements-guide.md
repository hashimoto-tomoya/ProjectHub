# 機能要件セクション 作成ガイド

## 目次

1. [Smallテンプレートの場合](#smallテンプレートの場合)
2. [共通の記述方針](#共通の記述方針)
3. [機能モジュールの洗い出し](#機能モジュールの洗い出し)
4. [代表的な機能モジュール](#代表的な機能モジュール)
5. [品質基準](#品質基準全機能共通)

## Smallテンプレートの場合

Smallテンプレートでは、全機能要件を **`functional-requirements.md`** 1ファイルに統合して記述する。
Fullでは機能モジュールごとに独立ファイルとなるが、Smallでは1ファイル内のセクションとしてまとめる。

### 推奨構成

```markdown
# 機能要件

## 共通事項

### 優先度の定義
{P0〜P3の定義テーブル}

### 機能IDの命名規則
{FR-{カテゴリ略称}-{連番}}

## {機能モジュール1}

### 機能概要
{1〜2文で目的を説明}

### 機能一覧

| 機能ID | 機能名 | 概要 | 優先度 |
|--------|--------|------|--------|
| FR-XXX-001 | {機能名} | {概要} | P0 |
| ... | ... | ... | ... |

### 主要機能の詳細仕様
{P0/P1の機能について入力・出力・処理ロジック・バリデーションを記述}

## {機能モジュール2}
{同様の構成}

...
```

### Fullとの主な差異

- 全機能モジュールを1ファイル内のH2セクションとしてまとめる
- 詳細仕様はP0/P1の主要機能に絞る（P2/P3は機能一覧テーブルでの列挙に留める）
- 画面イメージの参照は省略可（基本設計フェーズで扱う）
- 以下のガイド内容を参考にしつつ、小規模プロジェクトに必要十分な粒度で記述する

---

## 共通の記述方針

### 機能要件の記述フォーマット

各サブセクションで以下を記述する：

1. **機能概要**: 1〜2文で機能の目的を説明
2. **機能一覧**: テーブル形式で機能ID・機能名・概要・優先度を列挙
3. **詳細仕様**: 各機能の入力/出力/処理ロジック/バリデーション
4. **画面イメージ**: 必要に応じてワイヤーフレームの参照を記載

### 優先度の定義

| 優先度 | ラベル | 説明 |
|--------|--------|------|
| P0 | Must | MVP必須。これがないとサービス提供不可 |
| P1 | Should | 初回リリースに含めたい重要機能 |
| P2 | Could | あれば望ましいが後回し可能 |
| P3 | Won't | 今回スコープ外（将来検討） |

### 機能IDの命名規則

`FR-{カテゴリ略称}-{連番}`

カテゴリ略称はプロジェクトに応じて定義する。3〜4文字の英字大文字を使用。

**例:**
- FR-USR-001: ユーザー管理
- FR-AUTH-001: 認証・認可
- FR-SRCH-001: 検索
- FR-ADM-001: 管理機能

---

## 機能モジュールの洗い出し

プロジェクトのドメイン・スコープに基づき、機能モジュールを洗い出す。
以下の観点で漏れなく整理する：

1. **エンドユーザー向け機能** — ユーザーが直接操作する機能
2. **管理者向け機能** — 運営・管理者が使用するバックオフィス機能
3. **システム間連携機能** — 外部サービス・APIとの連携機能
4. **共通基盤機能** — 認証、通知、ログ等の横断的機能

### ドメイン別の典型的な機能モジュール例

| ドメイン | 典型的な機能モジュール |
|----------|----------------------|
| ECサイト | ユーザー管理、商品管理、検索・フィルタ、カート・購入、決済、注文管理、レビュー、レコメンド、管理機能 |
| SaaS | ユーザー管理、テナント管理、サブスクリプション管理、ダッシュボード、通知、分析・レポート、API、管理機能 |
| 社内業務システム | ユーザー管理、ワークフロー、承認管理、マスタ管理、帳票出力、通知、監査ログ、管理機能 |
| SNS・コミュニティ | ユーザー管理、プロフィール、投稿・タイムライン、メッセージ、通知、検索、モデレーション、管理機能 |

---

## 代表的な機能モジュール

以下はWebアプリケーションで頻出する機能モジュールの記述ガイドである。
プロジェクトに該当するもののみ参照し、ドメイン固有のモジュールは同様の粒度で追加すること。

### ユーザー管理

| 機能 | 主要検討項目 |
|------|-------------|
| 会員登録 | メール認証/SNS連携/必須項目/本人確認 |
| ログイン | 認証方式/SNSログイン/2要素認証/セッション有効期限 |
| プロフィール管理 | 個人情報編集/設定管理 |
| パスワード管理 | ポリシー(最低文字数,複雑さ)/リセットフロー/変更通知 |
| 退会 | 退会フロー/データ削除(個人情報保護法対応)/退会後のデータ保持 |

### コンテンツ管理

| 機能 | 主要検討項目 |
|------|-------------|
| コンテンツ情報 | 名称/説明/メタデータ/メディア(画像,動画) |
| カテゴリ・タグ管理 | 階層カテゴリ/タグ/分類体系 |
| 公開管理 | 公開/非公開/予約公開/公開期間設定 |
| バージョン管理 | 履歴保持/ロールバック |

### 検索・フィルタ

| 機能 | 主要検討項目 |
|------|-------------|
| キーワード検索 | 全文検索/部分一致/サジェスト/検索履歴 |
| フィルタリング | 属性別絞り込み/複合条件 |
| ソート | 各種ソート条件（新着/人気/関連度 等） |
| ファセット検索 | 絞り込み件数表示/複数条件AND/OR |

### 決済・課金

| 機能 | 主要検討項目 |
|------|-------------|
| 対応決済方法 | クレジットカード/銀行振込/電子マネー/外部決済サービス |
| 決済処理 | 与信確保/売上確定/返金(全額,部分)/キャンセル |
| セキュリティ | PCI DSS準拠/3Dセキュア/トークン化/不正検知 |
| 決済代行連携 | 利用サービス/Webhook/冪等性 |

### 注文・トランザクション管理

| 機能 | 主要検討項目 |
|------|-------------|
| ステータス管理 | 状態遷移の定義（ドメインに応じた状態を定義） |
| 履歴管理 | 一覧表示/詳細表示/検索・フィルタ |
| キャンセル | キャンセル可能条件/キャンセル処理/返金連携 |
| 通知 | ステータス変更通知/メール・プッシュ通知 |

### 通知

| 機能 | 主要検討項目 |
|------|-------------|
| 通知チャネル | メール/プッシュ通知/アプリ内通知/SMS |
| 通知テンプレート | テンプレート管理/パーソナライズ |
| 配信設定 | ユーザー別配信設定/配信停止 |

### レビュー・評価

| 機能 | 主要検討項目 |
|------|-------------|
| レビュー投稿 | 評価点/テキスト/画像添付/投稿資格 |
| レビュー表示 | 平均評価/分布/並べ替え/「参考になった」投票 |
| レビュー管理 | 承認フロー(自動/手動)/不適切コンテンツフィルタ/通報 |

### 管理機能（バックオフィス）

| 機能 | 主要検討項目 |
|------|-------------|
| ダッシュボード | 主要指標サマリー/アラート/直近アクティビティ |
| ユーザー管理 | 検索/詳細表示/編集/停止・復帰 |
| コンテンツ管理 | お知らせ/バナー/その他運用コンテンツ |
| レポート・分析 | 各種レポート/アクセス分析/エクスポート |
| 権限管理 | ロール定義/権限割当/操作ログ |

---

## 品質基準（全機能共通）

- 各機能に一意のIDが付与されていること
- 優先度（P0〜P3）が設定されていること
- 入力/出力/処理が明確であること
- バリデーションルールが定義されていること
- エラー時の挙動が記述されていること
- 他機能との依存関係が明記されていること
